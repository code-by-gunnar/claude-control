---
phase: 04-web-dashboard
plan: 03
type: execute
wave: 3
depends_on: ["04-02"]
files_modified:
  - dashboard/src/pages/SettingsPage.tsx
  - dashboard/src/pages/MemoryPage.tsx
  - dashboard/src/pages/McpPage.tsx
  - dashboard/src/App.tsx
autonomous: true

must_haves:
  truths:
    - "User can see all settings with their effective values and source scope"
    - "User can expand a setting to see its full override chain"
    - "User can view list of CLAUDE.md files with scope and size"
    - "User can click a CLAUDE.md file to see its content"
    - "User can see all MCP servers with type, scope, and masked config"
  artifacts:
    - path: "dashboard/src/pages/SettingsPage.tsx"
      provides: "Settings viewer with override chain display"
      min_lines: 50
    - path: "dashboard/src/pages/MemoryPage.tsx"
      provides: "CLAUDE.md file list with content viewer"
      min_lines: 50
    - path: "dashboard/src/pages/McpPage.tsx"
      provides: "MCP servers list with details display"
      min_lines: 50
  key_links:
    - from: "dashboard/src/pages/SettingsPage.tsx"
      to: "/api/settings"
      via: "fetch settings data"
      pattern: "fetch.*api/settings"
    - from: "dashboard/src/pages/MemoryPage.tsx"
      to: "/api/memory"
      via: "fetch memory data"
      pattern: "fetch.*api/memory"
    - from: "dashboard/src/pages/McpPage.tsx"
      to: "/api/mcp"
      via: "fetch MCP data"
      pattern: "fetch.*api/mcp"
    - from: "dashboard/src/App.tsx"
      to: "dashboard/src/pages/SettingsPage.tsx"
      via: "React Router route at /settings"
      pattern: "SettingsPage"
---

<objective>
Implement Settings, Memory, and MCP viewer panels in the web dashboard.

Purpose: Enable users to browse their settings with override chains, view CLAUDE.md contents, and inspect MCP server configurations â€” all through the web UI.
Output: Three fully functional config viewer pages with data from the API.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-web-dashboard/04-02-SUMMARY.md

@dashboard/src/App.tsx
@dashboard/src/lib/api.ts
@dashboard/src/components/Layout.tsx
@src/settings/types.ts
@src/mcp/types.ts
@src/scanner/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Settings panel with override chain display</name>
  <files>dashboard/src/pages/SettingsPage.tsx, dashboard/src/App.tsx</files>
  <action>
    1. Create `dashboard/src/pages/SettingsPage.tsx`:
       - Fetch settings from `/api/settings` on mount
       - Display as a table/list with columns: Key, Value, Scope, Source
       - Each row shows the effective (winning) value with a scope badge (colored pill: green for local, blue for project, gray for user, etc.)
       - Click/expand a row to reveal the full override chain:
         - Show all scopes that define this key
         - Winner marked with a checkmark or highlighted
         - Overridden values shown dimmed/struck-through
         - Each entry shows: scope badge, value, file path
       - Use expandable rows (click to toggle) with Tailwind transitions
       - Search/filter input at top: filter settings by key name (client-side filter on already-fetched data)
       - Handle loading and empty states
       - Value display: for objects/arrays show formatted JSON, for primitives show as-is

    2. Update `dashboard/src/App.tsx`:
       - Replace Settings placeholder route with actual SettingsPage component

    Design notes:
    - Table style: clean with subtle borders, alternating row backgrounds
    - Scope badges: small colored pills (managed=gray, user=blue, project=green, local=purple)
    - Override chain: indented list below the row when expanded, with visual connector lines or indentation
    - Filter input: full-width, top of page, with "Filter settings..." placeholder
  </action>
  <verify>
    `npm run build` succeeds.
    Dashboard at /settings shows settings table with real data.
    Clicking a setting row expands to show override chain.
    Filter input narrows the displayed settings.
  </verify>
  <done>
    Settings page shows all settings with effective values, scope badges, and expandable override chains.
    Filter works for narrowing by key name.
  </done>
</task>

<task type="auto">
  <name>Task 2: Memory and MCP panels</name>
  <files>dashboard/src/pages/MemoryPage.tsx, dashboard/src/pages/McpPage.tsx, dashboard/src/App.tsx</files>
  <action>
    1. Create `dashboard/src/pages/MemoryPage.tsx`:
       - Fetch memory data from `/api/memory` on mount
       - Display list of CLAUDE.md files as cards:
         - Each card shows: scope badge, file path (shortened with ~), file size
         - Click card to expand and show file content
       - Content viewer:
         - Render raw markdown content in a styled `<pre>` block with monospace font
         - Light gray background, scrollable if content is long
         - Close/collapse button to hide content
       - Handle: no files found, loading state
       - Show total count in page header

    2. Create `dashboard/src/pages/McpPage.tsx`:
       - Fetch MCP data from `/api/mcp` on mount
       - Display servers as a list/table:
         - Each server row: name, type (command/http), scope badge
         - Click to expand and show details:
           - For command type: command, args (as formatted list)
           - For http type: URL
           - Environment variables: key names only, values shown as "***" (already masked by API)
           - Headers: shown with masked values (already masked by API)
       - Duplicates section: if any duplicates detected, show warning banner at top with duplicate server names and their conflicting scopes
       - Handle: no servers configured, loading state

    3. Update `dashboard/src/App.tsx`:
       - Replace Memory and MCP placeholder routes with actual page components

    Design notes:
    - Memory cards: white bg, rounded, shadow, scope badge in top-right corner
    - Content preview: monospace font, bg-gray-100, max-height with overflow-y-auto
    - MCP server details: key-value pairs in a definition list style
    - Masked values: show in gray italics to indicate they're hidden
    - Duplicate warnings: yellow/amber background banner
  </action>
  <verify>
    `npm run build` succeeds.
    Dashboard at /memory shows CLAUDE.md files, clicking expands content.
    Dashboard at /mcp shows MCP servers, clicking expands details with masked secrets.
    Duplicate server warnings display if applicable.
  </verify>
  <done>
    Memory page lists CLAUDE.md files with expandable content viewer.
    MCP page lists servers with expandable details and masked secrets.
    Duplicate detection warnings display when applicable.
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds
- [ ] /settings page shows settings table with expandable override chains
- [ ] /settings filter input works for narrowing settings
- [ ] /memory page shows CLAUDE.md files with expandable content
- [ ] /mcp page shows MCP servers with expandable details
- [ ] Scope badges display correctly on all pages
- [ ] Loading and empty states handled gracefully
</verification>

<success_criteria>
- All tasks completed
- Settings, Memory, and MCP pages display real data from API
- Override chain and detail expansion works via click interaction
- No TypeScript errors or build failures
</success_criteria>

<output>
After completion, create `.planning/phases/04-web-dashboard/04-03-SUMMARY.md`
</output>
