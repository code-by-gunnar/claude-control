---
phase: 04-web-dashboard
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - dashboard/index.html
  - dashboard/vite.config.ts
  - dashboard/postcss.config.js
  - dashboard/tailwind.config.ts
  - dashboard/tsconfig.json
  - dashboard/src/main.tsx
  - dashboard/src/index.css
  - dashboard/src/App.tsx
  - dashboard/src/components/Layout.tsx
  - dashboard/src/components/Sidebar.tsx
  - dashboard/src/pages/OverviewPage.tsx
  - dashboard/src/lib/api.ts
  - package.json
  - tsup.config.ts
autonomous: true

must_haves:
  truths:
    - "npm run build produces both dist/index.js (CLI) and dist/dashboard/index.html (SPA)"
    - "Dashboard loads in browser at localhost:3737 when server is running"
    - "Sidebar shows navigation links to all config sections"
    - "Overview page displays summary cards with config counts"
  artifacts:
    - path: "dashboard/src/App.tsx"
      provides: "React app root with React Router"
      min_lines: 20
    - path: "dashboard/src/components/Layout.tsx"
      provides: "Dashboard shell with sidebar and content area"
      min_lines: 20
    - path: "dashboard/src/pages/OverviewPage.tsx"
      provides: "Overview page with summary cards"
      min_lines: 30
    - path: "dashboard/src/lib/api.ts"
      provides: "API client functions for fetching data from server"
      min_lines: 20
  key_links:
    - from: "dashboard/src/App.tsx"
      to: "dashboard/src/pages/OverviewPage.tsx"
      via: "React Router route"
      pattern: "OverviewPage"
    - from: "dashboard/src/pages/OverviewPage.tsx"
      to: "dashboard/src/lib/api.ts"
      via: "fetches scan summary"
      pattern: "fetch.*api"
    - from: "dashboard/src/lib/api.ts"
      to: "/api/*"
      via: "HTTP fetch calls to server API"
      pattern: "fetch.*(/api/)"
---

<objective>
Set up React SPA with Vite + Tailwind, integrate into build pipeline, and create dashboard shell with overview page.

Purpose: Provide the frontend foundation — build tooling, layout components, routing, and the overview page that ties all config areas together visually.
Output: Working React dashboard that loads in the browser with sidebar navigation and summary overview.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-web-dashboard/04-01-SUMMARY.md

@src/server/index.ts
@src/server/routes.ts
@package.json
@tsup.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Set up React + Vite + Tailwind build pipeline</name>
  <files>dashboard/index.html, dashboard/vite.config.ts, dashboard/postcss.config.js, dashboard/tailwind.config.ts, dashboard/tsconfig.json, dashboard/src/main.tsx, dashboard/src/index.css, package.json, tsup.config.ts</files>
  <action>
    1. Install dev dependencies at root: `react`, `react-dom`, `react-router-dom`, `@types/react`, `@types/react-dom`, `@vitejs/plugin-react`, `tailwindcss`, `postcss`, `autoprefixer`, `@tailwindcss/vite` (check if Tailwind v4 uses the Vite plugin approach — if so, use `@tailwindcss/vite`; if Tailwind v3, use postcss config). Add all as devDependencies since they're only needed at build time.

    2. Create `dashboard/` directory structure:
       ```
       dashboard/
       ├── index.html          # Vite entry HTML
       ├── vite.config.ts      # Vite config
       ├── postcss.config.js   # PostCSS (if needed for Tailwind v3)
       ├── tailwind.config.ts  # Tailwind config (if needed for Tailwind v3)
       ├── tsconfig.json       # TypeScript for React (jsx: react-jsx)
       └── src/
           ├── main.tsx        # React entry point
           └── index.css       # Tailwind directives
       ```

    3. Configure `dashboard/vite.config.ts`:
       - Plugin: @vitejs/plugin-react
       - If using Tailwind v4: add @tailwindcss/vite plugin
       - build.outDir: `'../dist/dashboard'`
       - build.emptyOutDir: `true` (only cleans dist/dashboard/, not dist/)
       - base: `'/'` (served from root)

    4. Create `dashboard/tsconfig.json`:
       - Extend or mirror root config but add `"jsx": "react-jsx"`
       - Include: `["src"]`
       - CompilerOptions: strict, ESNext module, bundler moduleResolution

    5. Create `dashboard/src/main.tsx`: Standard React 18 createRoot entry
    6. Create `dashboard/src/index.css`: Tailwind CSS import (`@import "tailwindcss"` for v4 or `@tailwind base/components/utilities` for v3)

    7. Update `package.json` scripts:
       ```json
       "build": "tsup && vite build --config dashboard/vite.config.ts",
       "build:cli": "tsup",
       "build:dashboard": "vite build --config dashboard/vite.config.ts",
       "dev:dashboard": "vite --config dashboard/vite.config.ts"
       ```
       Build order matters: tsup first (has clean:true, wipes dist/), then vite (adds dist/dashboard/).

    8. Verify the Tailwind version installed — if v4 (which is likely in 2026), use the v4 setup pattern:
       - No postcss.config.js or tailwind.config.ts needed
       - Use `@tailwindcss/vite` plugin in vite.config.ts
       - CSS file uses `@import "tailwindcss"`
       If v3, use the traditional postcss + tailwind.config approach.

    Important: Do NOT modify tsup.config.ts's `clean: true` — the build order (tsup then vite) handles this correctly.
  </action>
  <verify>
    `npm run build` succeeds — produces both `dist/index.js` and `dist/dashboard/index.html`.
    `npm run dev:dashboard` starts Vite dev server with hot reload.
    `dist/dashboard/` contains index.html, assets/ with JS and CSS bundles.
  </verify>
  <done>
    Build pipeline produces CLI and dashboard in single `npm run build`.
    Vite dev server works for frontend development.
    Tailwind CSS is functional (utility classes work).
  </done>
</task>

<task type="auto">
  <name>Task 2: Create dashboard layout shell + overview page</name>
  <files>dashboard/src/App.tsx, dashboard/src/components/Layout.tsx, dashboard/src/components/Sidebar.tsx, dashboard/src/pages/OverviewPage.tsx, dashboard/src/lib/api.ts</files>
  <action>
    1. Create `dashboard/src/lib/api.ts` — API client:
       - Export async functions: `fetchScan()`, `fetchStatus()`, `fetchSettings()`, `fetchMemory()`, `fetchMcp()`, `fetchHooks()`, `fetchCommands()`, `fetchPermissions()`
       - Each calls `fetch('/api/{endpoint}')` and returns parsed JSON
       - Handle errors gracefully (try/catch, return null or throw with message)
       - Base URL is relative (same origin as dashboard)

    2. Create `dashboard/src/components/Sidebar.tsx`:
       - Navigation links using React Router's `NavLink`:
         - Overview (/) — icon: grid/dashboard
         - Settings (/settings) — icon: gear/cog
         - Memory (/memory) — icon: document/file
         - MCP Servers (/mcp) — icon: server/plug
         - Hooks (/hooks) — icon: lightning/zap
         - Permissions (/permissions) — icon: shield/lock
       - Active link highlighted with Tailwind classes (bg color change)
       - Use simple Unicode characters or SVG for icons (no icon library dependency)
       - Footer: "claude-ctl v0.1.0" text

    3. Create `dashboard/src/components/Layout.tsx`:
       - Flex layout: sidebar (fixed width ~240px) + main content area
       - Sidebar component on the left
       - Main area with padding, renders `<Outlet />` from React Router
       - Background: neutral gray (e.g., bg-gray-50 or bg-slate-50)
       - Sidebar: darker background (e.g., bg-gray-900 text-gray-100)

    4. Create `dashboard/src/pages/OverviewPage.tsx`:
       - Fetch data from `/api/scan` and `/api/status` on mount using useEffect + useState
       - Display summary cards in a grid (2x3 or responsive):
         - Config Files: found/total count
         - Settings: number of resolved settings
         - CLAUDE.md Files: count of existing memory files
         - MCP Servers: count of servers
         - Hooks: count of configured events
         - Permissions: count of rules
       - Each card: white background, rounded, shadow, large number + label
       - Loading state: skeleton or "Loading..." text
       - Error state: show error message
       - Cards should link to their respective detail pages

    5. Create `dashboard/src/App.tsx`:
       - BrowserRouter with Routes:
         - `/` → Layout with OverviewPage
         - `/settings` → placeholder (Phase 04-03 will implement)
         - `/memory` → placeholder
         - `/mcp` → placeholder
         - `/hooks` → placeholder
         - `/permissions` → placeholder
       - Placeholder pages: simple `<div>Coming soon</div>` components inline
       - Import index.css for Tailwind

    Design notes:
    - Use a professional, minimal aesthetic — this is a dev tool, not a marketing site
    - Color scheme: dark sidebar (slate-900), light content area (slate-50), blue accents for active nav
    - Cards: white background, subtle shadow, rounded-lg
    - Typography: system font stack (font-sans in Tailwind)
    - No external fonts or assets needed
  </action>
  <verify>
    `npm run build` succeeds.
    `node dist/index.js dashboard --no-open` starts server.
    Browser at http://localhost:3737 shows dashboard with sidebar and overview cards.
    Clicking sidebar links navigates between sections (placeholders for non-overview pages).
    Overview cards show actual data from API (file counts, settings count, etc.).
  </verify>
  <done>
    Dashboard loads in browser with sidebar navigation.
    Overview page displays 6 summary cards with live data from API.
    React Router handles client-side navigation.
    Layout is clean and professional.
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` produces both `dist/index.js` and `dist/dashboard/index.html`
- [ ] `node dist/index.js dashboard --no-open` serves dashboard at http://localhost:3737
- [ ] Dashboard shows sidebar with 6 navigation links
- [ ] Overview page displays summary cards with live config data
- [ ] Sidebar navigation works (clicking links changes content area)
- [ ] No TypeScript errors in either CLI or dashboard code
- [ ] Existing CLI commands still work (`node dist/index.js scan`)
</verification>

<success_criteria>
- All tasks completed
- Build pipeline produces CLI + dashboard in single command
- Dashboard loads in browser with working layout
- Overview page shows real data from API
- No regressions to existing CLI functionality
</success_criteria>

<output>
After completion, create `.planning/phases/04-web-dashboard/04-02-SUMMARY.md`
</output>
