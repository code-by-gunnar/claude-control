---
phase: 10-health-deeplinks-error-recovery
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/health/types.ts
  - src/health/resolver.ts
  - dashboard/src/lib/api.ts
  - dashboard/src/pages/HealthPage.tsx
autonomous: true

must_haves:
  truths:
    - "Health recommendations display as clickable links to relevant dashboard pages"
    - "Clicking a recommendation link navigates to the correct page (e.g., Memory check → /memory)"
    - "Recommendations still display text description alongside the link"
  artifacts:
    - path: "src/health/types.ts"
      provides: "HealthCheck with deeplink field"
      contains: "deeplink"
    - path: "src/health/resolver.ts"
      provides: "Category-to-route mapping for deeplinks"
      contains: "CATEGORY_ROUTES"
    - path: "dashboard/src/pages/HealthPage.tsx"
      provides: "Linked recommendation rendering"
      contains: "Link"
  key_links:
    - from: "src/health/resolver.ts"
      to: "HealthCheck.deeplink"
      via: "CATEGORY_ROUTES mapping applied during check construction"
      pattern: "deeplink.*CATEGORY_ROUTES"
    - from: "dashboard/src/pages/HealthPage.tsx"
      to: "React Router Link"
      via: "check.deeplink rendered as Link component"
      pattern: "<Link.*to=.*deeplink"
---

<objective>
Add deeplinks to health recommendations so each failed check links to its relevant dashboard page.

Purpose: Satisfies GUIDE-03 — users can navigate directly from health recommendations to the page where they can address the issue.
Output: Health checks include deeplink routes; HealthPage renders recommendations as clickable links.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-empty-states/09-01-SUMMARY.md

@src/health/types.ts
@src/health/resolver.ts
@dashboard/src/lib/api.ts
@dashboard/src/pages/HealthPage.tsx
@dashboard/src/components/Sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add deeplink field to HealthCheck and map categories to routes</name>
  <files>src/health/types.ts, src/health/resolver.ts</files>
  <action>
    In `src/health/types.ts`:
    - Add `deeplink?: string` field to HealthCheck interface (optional — route path like "/memory")

    In `src/health/resolver.ts`:
    - Add a `CATEGORY_ROUTES` constant mapping category names to dashboard routes:
      ```
      Memory → "/memory"
      Settings → "/settings"
      MCP → "/mcp"
      Hooks → "/hooks"
      Permissions → "/permissions"
      ```
    - In each check-building function (checkMemory, checkSettings, checkMcp, checkHooks, checkPermissions), add `deeplink: CATEGORY_ROUTES[category]` to every HealthCheck object.
    - The `recommendations: string[]` array in HealthResult stays unchanged for CLI backward compatibility. The deeplinks live on the HealthCheck objects inside categories, which the dashboard already receives.
  </action>
  <verify>npm run build succeeds with no TypeScript errors; npm test passes</verify>
  <done>Every HealthCheck object includes a deeplink field pointing to the relevant dashboard route. HealthResult API response shape unchanged (recommendations still string[]).</done>
</task>

<task type="auto">
  <name>Task 2: Update dashboard types and HealthPage to render linked recommendations</name>
  <files>dashboard/src/lib/api.ts, dashboard/src/pages/HealthPage.tsx</files>
  <action>
    In `dashboard/src/lib/api.ts`:
    - Add `deeplink?: string` to the HealthCheck interface

    In `dashboard/src/pages/HealthPage.tsx`:
    - Import `Link` from `react-router-dom`
    - Replace the recommendations section (lines ~205-220) that currently iterates over `health.recommendations` (string[])
    - Instead, derive recommendations from the category checks directly:
      ```tsx
      const recommendations = health.categories
        .flatMap(cat => cat.checks)
        .filter(check => !check.passed && check.recommendation)
        .sort((a, b) => b.weight - a.weight);
      ```
    - Render each recommendation with a Link when deeplink exists:
      - Number badge (existing style)
      - Recommendation text
      - Small arrow-right link/button that navigates to check.deeplink (e.g., "View Settings →")
      - Use Link component: `<Link to={check.deeplink} className="...">`
      - Style the link as a small pill/button: text-blue-600, hover:text-blue-800, text-xs, with right arrow icon
    - If no deeplink (shouldn't happen with current categories, but defensive), render plain text as before
  </action>
  <verify>npm run build succeeds; manually verify HealthPage renders recommendation links by checking the built output</verify>
  <done>HealthPage recommendations each show a clickable link to the relevant dashboard page. Links use React Router (no page reload).</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm test` passes all tests
- [ ] No TypeScript errors in src/ or dashboard/
- [ ] HealthCheck type includes deeplink field
- [ ] All 9 health checks in resolver have deeplink set
- [ ] HealthPage renders recommendations with Link components
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Health recommendations display as clickable links in dashboard
- Clicking link navigates to correct page via React Router
- CLI output unchanged (recommendations still string[])
  </success_criteria>

<output>
After completion, create `.planning/phases/10-health-deeplinks-error-recovery/10-01-SUMMARY.md`
</output>
