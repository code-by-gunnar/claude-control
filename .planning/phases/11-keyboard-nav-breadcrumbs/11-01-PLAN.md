---
phase: 11-keyboard-nav-breadcrumbs
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [dashboard/src/hooks/useKeyboardNav.ts, dashboard/src/components/KeyboardShortcutsOverlay.tsx, dashboard/src/components/Layout.tsx]
autonomous: true

must_haves:
  truths:
    - "G+key combos navigate to any dashboard page without mouse"
    - "? key shows help overlay listing all keyboard shortcuts"
    - "Help overlay dismisses with Escape or clicking outside"
    - "Keyboard shortcuts don't fire when typing in input fields"
  artifacts:
    - path: "dashboard/src/hooks/useKeyboardNav.ts"
      provides: "G+key keyboard navigation handler with route mapping"
      min_lines: 30
    - path: "dashboard/src/components/KeyboardShortcutsOverlay.tsx"
      provides: "Help overlay showing all available shortcuts"
      min_lines: 40
  key_links:
    - from: "dashboard/src/hooks/useKeyboardNav.ts"
      to: "react-router navigate"
      via: "useNavigate hook"
      pattern: "useNavigate"
    - from: "dashboard/src/components/Layout.tsx"
      to: "dashboard/src/hooks/useKeyboardNav.ts"
      via: "hook invocation"
      pattern: "useKeyboardNav"
    - from: "dashboard/src/components/Layout.tsx"
      to: "dashboard/src/components/KeyboardShortcutsOverlay.tsx"
      via: "component render"
      pattern: "KeyboardShortcutsOverlay"
---

<objective>
Add keyboard navigation to the dashboard — G+key combos navigate to any page, and ? shows a help overlay listing all available shortcuts.

Purpose: Enable mouse-free navigation (NAV-02) and discoverability of shortcuts (NAV-03).
Output: useKeyboardNav hook, KeyboardShortcutsOverlay component, wired into Layout.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@dashboard/src/components/Layout.tsx
@dashboard/src/components/Sidebar.tsx
@dashboard/src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useKeyboardNav hook and wire into Layout</name>
  <files>dashboard/src/hooks/useKeyboardNav.ts, dashboard/src/components/Layout.tsx</files>
  <action>
    Create `dashboard/src/hooks/useKeyboardNav.ts`:

    Implement a two-key chord system (G then letter) using vanilla keyboard events. No external dependencies.

    **Shortcut mapping (G + key → route):**
    - G+O → / (Overview)
    - G+S → /settings
    - G+M → /memory
    - G+P → /permissions
    - G+C → /mcp (MCP Servers)
    - G+L → /plugins (pLugins)
    - G+K → /marketplaces (marKetplaces)
    - G+H → /hooks
    - G+A → /agents
    - G+I → /skills (skIlls)
    - G+E → /health (hEalth)
    - G+J → /projects (proJects)
    - ? → toggle help overlay

    **Implementation details:**
    - Export a `SHORTCUTS` array of `{ key: string; route: string; label: string }` so the overlay can reuse it.
    - Use `useEffect` with `keydown` listener on `document`.
    - Track "waiting for second key" state with a ref. When `g` is pressed, set a flag. On next keydown within 1 second, check if it matches a shortcut. Clear flag on timeout or match.
    - Guard: Skip all shortcuts when `event.target` is an `input`, `textarea`, `select`, or has `contentEditable`. This prevents shortcuts from firing while typing.
    - Guard: Skip when any modifier key is held (Ctrl, Alt, Meta, Shift) to avoid conflicting with browser/OS shortcuts.
    - `?` key (Shift+/) toggles the help overlay — accept the callback `onToggleHelp` as a parameter.
    - Use `useNavigate()` from react-router-dom to navigate.
    - The hook signature: `useKeyboardNav({ onToggleHelp: () => void })`.

    Wire into `Layout.tsx`:
    - Add `const [showShortcuts, setShowShortcuts] = useState(false)` state.
    - Call `useKeyboardNav({ onToggleHelp: () => setShowShortcuts(prev => !prev) })`.
    - Render `<KeyboardShortcutsOverlay open={showShortcuts} onClose={() => setShowShortcuts(false)} />` (component created in Task 2).
    - Import will reference the Task 2 component — if building incrementally, add the import and render conditionally on `showShortcuts` even before the overlay component exists.
  </action>
  <verify>npm run build succeeds (TypeScript compiles without errors)</verify>
  <done>G+key combos navigate to correct pages. Shortcuts don't fire in input fields. ? toggles help overlay state in Layout.</done>
</task>

<task type="auto">
  <name>Task 2: Create KeyboardShortcutsOverlay component</name>
  <files>dashboard/src/components/KeyboardShortcutsOverlay.tsx</files>
  <action>
    Create `dashboard/src/components/KeyboardShortcutsOverlay.tsx`:

    **Props:** `{ open: boolean; onClose: () => void }`

    **Behavior:**
    - When `open` is false, render nothing (return null).
    - When `open` is true, render a centered modal overlay with backdrop.
    - Pressing Escape calls `onClose`.
    - Clicking the backdrop (outside the modal content) calls `onClose`.

    **Layout:**
    - Semi-transparent dark backdrop (`bg-black/50`) covering full viewport, z-50.
    - Centered white card (dark theme: `bg-slate-800 text-slate-200`) with rounded corners and shadow.
    - Title: "Keyboard Shortcuts" with a close button (X icon).
    - Group shortcuts by sidebar section: ungrouped (Overview), Configuration, Extensions, Workspace.
    - Each shortcut row: key badge (e.g., `G then O`) on the left, page label on the right.
    - Key badges styled as `bg-slate-700 text-slate-200 font-mono text-xs px-2 py-1 rounded` inline blocks.
    - Footer row: `?` key → "Toggle this help"

    **Import SHORTCUTS from useKeyboardNav.ts** to render the list. Group them by matching routes to the sidebar navGroups structure. Alternatively, define groups inline matching the sidebar sections (Overview, Configuration, Extensions, Workspace) with their shortcut items.

    **Escape handling:** Use a `useEffect` that adds a `keydown` listener for Escape when `open` is true, and removes it on cleanup.
  </action>
  <verify>npm run build succeeds. Overlay renders when open=true, dismisses with Escape.</verify>
  <done>Help overlay shows all 12 G+key shortcuts grouped by section, plus ? shortcut. Dismissible via Escape and backdrop click.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm test` passes (no regressions)
- [ ] useKeyboardNav.ts exists with all 12 route shortcuts + ? handler
- [ ] KeyboardShortcutsOverlay.tsx exists and renders shortcut list
- [ ] Layout.tsx imports and uses both hook and overlay
- [ ] Shortcuts are guarded against input fields and modifier keys
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- G+key navigates to correct route for all 12 pages
- ? toggles help overlay
- Overlay dismisses with Escape and backdrop click
- Shortcuts don't fire in text inputs
  </success_criteria>

<output>
After completion, create `.planning/phases/11-keyboard-nav-breadcrumbs/11-01-SUMMARY.md`
</output>
